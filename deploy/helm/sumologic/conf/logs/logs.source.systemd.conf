<match host.**>
  @type relabel
  @label @SYSTEMD
</match>
<label @SYSTEMD>
  <filter host.**>
    @type kubernetes_sumologic
    source_category {{ .Values.fluentd.logs.systemd.sourceCategory | quote }}
    source_category_prefix {{ .Values.fluentd.logs.systemd.sourceCategoryPrefix | quote }}
    exclude_facility_regex {{ .Values.fluentd.logs.systemd.excludeFacilityRegex | quote }}
    exclude_host_regex {{ .Values.fluentd.logs.systemd.excludeHostRegex | quote }}
    exclude_priority_regex {{ .Values.fluentd.logs.systemd.excludePriorityRegex | quote }}
    exclude_unit_regex {{ .Values.fluentd.logs.systemd.excludeUnitRegex | quote }}
  </filter>
  <filter host.**>
    @type record_modifier
    <record>
      _sumo_metadata ${record["_sumo_metadata"][:source] = tag_parts[1]; record["_sumo_metadata"]}
    </record>
  </filter>
{{- .Values.fluentd.logs.systemd.extraPluginConf | nindent 4 }}
  <match host.**>
    @type sumologic
    @id sumologic.endpoint.logs.systemd
{{- .Values.fluentd.logs.systemd.outputConf | nindent 6 }}
    <buffer>
      {{- if eq .Values.fluentd.buffer.type "file" }}
      @type file
      path {{ .Values.fluentd.buffer.filePaths.logs.systemd }}
      {{- else }}
      @type memory
      {{- end }}
      @include buffer.output.conf
    </buffer>
  </match>
</label>