name: Sync Repositories

on:
  schedule:
    - cron: "0 0 * * *"
  workflow_dispatch:

jobs:
  sync-repositories:
    name: Sync container repositories
    strategy:
      matrix:
        include:
          - src_repository: quay.io/brancz/kube-rbac-proxy
            suffix: KUBE_RBAC_PROXY
    uses: ./.github/workflows/workflow-sync-repositories.yaml
    with:
      src_repository: ${{ matrix.src_repository }}
      dest_docker_namespace: docker.io/sumologic
      dest_ecr_namespace: public.ecr.aws/a4t4y2n3
    secrets:
      DOCKER_USERNAME: ${{ secrets[format('DOCKERHUB_LOGIN_{0}', matrix.suffix)] }}
      DOCKER_PASSWORD: ${{ secrets[format('DOCKERHUB_PASSWORD_{0}', matrix.suffix)] }}
      AWS_ACCESS_KEY_ID: ${{ secrets[format('AWS_ACCESS_KEY_ID_{0}', matrix.suffix)] }}
      AWS_SECRET_ACCESS_KEY: ${{ secrets[format('AWS_SECRET_ACCESS_KEY_{0}', matrix.suffix)] }}
