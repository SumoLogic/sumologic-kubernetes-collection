{
  "enabledManagers": ["custom.regex"],
  "postUpdateOptions": ["npmDedupe", "yarnDedupe"],
  "commitMessagePrefix": "chore(deps):",
  "commitMessageAction": "update",
  "commitMessageTopic": "{{depName}}",
  "commitMessageExtra": "to {{#if isPinDigest}}{{{newDigestShort}}}{{else}}{{#if isMajor}}{{prettyNewMajor}}{{else}}{{#if isSingleVersion}}{{prettyNewVersion}}{{else}}{{#if newValue}}{{{newValue}}}{{else}}{{{newDigestShort}}}{{/if}}{{/if}}{{/if}}{{/if}}",
  "customManagers": [
    {
      "customType": "regex",
      "description": "Update Sumo Logic container images in values.yaml (repository/tag pattern)",
      "fileMatch": ["^deploy/helm/sumologic/values\\.yaml$"],
      "matchStrings": [
        "repository:\\s*\"?(?<depName>public\\.ecr\\.aws/sumologic/sumologic-otel-collector)\"?\\s*\\n\\s*tag:\\s*\"?(?<currentValue>[^\"\\s]+)\"?"
      ],
      "datasourceTemplate": "docker",
      "versioningTemplate": "regex:^(?<major>0)\\.(?<minor>[0-9]+)\\.(?<patch>[0-9]+)-sumo-(?<build>[0-9]+)$"
    },
    {
      "customType": "regex",
      "description": "Update Sumo Logic container images in test files",
      "fileMatch": ["^tests/helm/testdata/goldenfile/.*\\.yaml$"],
      "matchStrings": [
        "image:\\s*\"?(?<depName>public\\.ecr\\.aws/sumologic/sumologic-otel-collector):(?<currentValue>[a-zA-Z0-9._-]+)\"?"
      ],
      "datasourceTemplate": "docker",
      "versioningTemplate": "regex:^(?<major>0)\\.(?<minor>[0-9]+)\\.(?<patch>[0-9]+)-sumo-(?<build>[0-9]+)$"
    },
    {
      "customType": "regex",
      "description": "Update version references in documentation tables",
      "fileMatch": ["^deploy/helm/sumologic/README\\.md$"],
      "matchStrings": [
        "\\|\\s*`(sumologic\\.otelcolImage\\.tag|opentelemetry-operator\\.manager\\.collectorImage\\.tag)`\\s*\\|.*?\\|\\s*`(?<currentValue>[0-9.]+(?:-[a-z0-9-]+)?)`\\s*\\|"
      ],
      "datasourceTemplate": "docker",
      "depNameTemplate": "public.ecr.aws/sumologic/sumologic-otel-collector",
      "versioningTemplate": "regex:^(?<major>0)\\.(?<minor>[0-9]+)\\.(?<patch>[0-9]+)-sumo-(?<build>[0-9]+)$"
    },
    {
      "customType": "regex",
      "description": "Update OpenTelemetry Collector version in docs README table",
      "fileMatch": ["^docs/README\\.md$"],
      "matchStrings": [
        "\\|\\s*OpenTelemetry Collector\\s*\\|\\s*(?<currentValue>[0-9]+\\.[0-9]+\\.[0-9]+)\\s*\\|"
      ],
      "datasourceTemplate": "docker",
      "depNameTemplate": "public.ecr.aws/sumologic/sumologic-otel-collector",
      "versioningTemplate": "loose",
      "extractVersionTemplate": "^(?<version>[0-9]+\\.[0-9]+\\.[0-9]+)"
    }
  ],
  "packageRules": [
    {
      "description": "Group OpenTelemetry Collector updates together",
      "matchDatasources": ["docker"],
      "matchPackageNames": ["public.ecr.aws/sumologic/sumologic-otel-collector"],
      "groupName": "sumologic-otel-collector",
      "separateMinorPatch": false,
      "allowedVersions": "/^0\\.[0-9]+\\.[0-9]+(\\-sumo\\-[0-9]+)?$/",
      "postUpgradeTasks": {
        "commands": [
          "timestamp=$(date +%s); echo 'chore(deps): Update OpenTelemetry Collector from {{{currentVersion}}} to {{{newVersion}}}' > .changelog/${timestamp}.changed.txt"
        ],
        "fileFilters": [".changelog/**"]
      }
    }
  ]
}